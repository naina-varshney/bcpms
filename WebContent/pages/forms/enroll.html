<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>BCPMS | Enrollment Form</title>
	<!-- Tell the browser to be responsive to screen width -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="../../plugins/fontawesome-free/css/all.min.css">
	<!-- overlayScrollbars -->
	<link rel="stylesheet" href="../../dist/css/adminlte.min.css">
	<style>
		body:not (.sidebar-mini-md) .content-wrapper,
		body:not (.sidebar-mini-md) .main-footer,
		body:not (.sidebar-mini-md) .main-header {
			transition: margin-left .3s ease-in-out;
			margin-left: 0px;
		}
	  form .error 
		{
			color: #ff0000;
		}
	</style>
</head>

<body class="hold-transition sidebar-mini">
	<!-- Site wrapper -->
	<div class="wrapper">
		<!-- Content Wrapper. Contains page content -->
		<div class="content-wrapper" style="min-height: 1246.8px;margin-left:0px;">
			<!-- Content Header (Page header) -->
			<section class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1>
								<b>Enrollment Form</b>
							</h1>
						</div>
					</div>
				</div>
				<!-- /.container-fluid -->
			</section>
			<!-- Main content -->
			<section class="content">
				<!-- Default box -->
				<div class="card">
				 <form id="enroll" >
					<!-- /.card-header -->
					<div class="card-body">
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label>Student ID</label>
									<input type="text" class="form-control" id="smartid" disabled>
								</div>
								<div class="form-group">
									<label>Student Name</label>
									<input type="text" class="form-control" id="studentname" disabled>
								</div>
								<div class="form-group">
									<label>Father's Name</label>
									<input type="text" class="form-control" id="fathername"  name="fName" placeholder="Enter your father's name*" required>
									<div id="fNameError"></div>
								</div>
								<div class="form-group">
									<label>Mother's Name</label>
									<input type="text" class="form-control" id="mothername" name="mName" placeholder="Enter your mother's name*" required>
									<div id="mNameError"></div>
								</div>
								<div class="form-group">
									<label>Guardian's Name</label>
									<input type="text" class="form-control" id="guardianname" name="gName" placeholder="Enter your guardian's name*" required>
								 	<div id="gNameError"></div>
								</div>
								<div class="form-group">
									<label>Date Of Birth</label>
									<input type="date" class="form-control" id="dob" name="bDate" placeholder="Enter your Date of birth*" required>
									<div id="bDateError"></div>
								</div>
								<div class="form-group">
									<label>Aadhar Number</label>
									<input type="number" class="form-control" id="aadhar" disabled>
								</div>
								<div class="form-group">
									<label>Choose Language</label>
									<select class="form-control select2bs4" id="language" name="language" style="width: 100%;" required>
										<option value="Select">Select*</option>
										<option>Hindi</option>
										<option>English</option>
									</select>
									<div id="languageError"></div>
								</div>
								<div class="form-group">
									<label>Pincode</label>
									<input type="text" class="form-control" id="pincode" name="pinCode" placeholder="Enter your pincode*" required>
									<div id="pinCodeError"></div>
								</div>
								<!-- /.form-group -->
							</div>
							<!-- /.col -->
							<div class="col-md-6">
								<!-- /.form-group -->
								<div class="form-group">
									<label>Hostel Name</label>
									<select class="form-control select2bs4" id="hostel" name="hostel" style="width: 100%;" required></select>
									<div id="hostelError"></div>
								</div>
								<div class="form-group">
									<label>Course Name</label>
									<select class="form-control select2bs4" name="cName" id="coursename" style="width: 100%;" required>
										<option value="Select">Select*</option>
										<option>BCA</option>
										<option>B.Tech</option>
										<option>M.Tech</option>
										<option>MCA</option>
									</select>
									 <div id="cNameError"></div>
								</div>
								<div class="form-group">
									<label>Enrollment Number</label>
									<input type="text" name="enrollmentNo" class="form-control" id="enrolmentNo" placeholder="Enter your enrollment no*" required>
									<div id="enrollmentNoError"></div>
								</div>
								<div class="form-group">
									<label for="email">Email_Id</label>
									<input type="email" class="form-control" id="email_id" disabled>
								</div>
								<div class="form-group">
									<label>Mobile Number</label>
									<input type="number" class="form-control" id="mobile" disabled>
								</div>
								<div class="form-group">
									<label>State</label>
									<select class="form-control select2bs4" id="state_dropdown" name="state" style="width: 100%;" required></select>
									 <div id="stateError"></div>
									<div class="form-group">
										<label>Address</label>
										<textarea class="form-control" id="address" placeholder="Permanent Address"></textarea>
									</div>
									<div class="form-group">
										<label>Select course in which you want to enroll</label>
										<select class="form-control select2bs4" name="cSelect" id="course" style="width: 100%;" required></select>
                                        <div id="cSelectError"></div>
									</div>
								</div>
							</div>
							<!-- /.form-group -->
						</div>
						<!-- /.col -->
					</div>
					<!-- /.row -->
					<div class="card-footer">
					<button type="submit" class="btn btn-primary float-right">Next</button>
					</div>
					</form>
				</div>
				<!-- /.card-body -->
				<!--card footer-->
				
		</div>
		<!-- /.card -->
		</section>
		<!-- /.content -->
	</div>
	<!-- /.content-wrapper -->
	</div>
	<!-- ./wrapper -->
	<!-- jQuery -->
	<script src="../../plugins/jquery/jquery.min.js"></script>
	<!-- Bootstrap 4 -->
	<script src="../../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
	<script src="../../dist/js/adminlte.min.js"></script>
	<script src="../../plugins/jquery-validation/jquery.validate.min.js"></script>
	<script src="../../plugins/jquery-validation/additional-methods.min.js"></script>
	<script src="../../dist/js/demo.js"></script>
	<script type="text/javascript">
	$(document).ready(function () {
	$.validator.addMethod("FathernameValidator", function(value, element) 
	{		return /^(Mr).{1}[A-Za-z]{3,}\s[A-Z]{1}[a-z]{1,}$/.test(value);}, 'Please enter a valid name.Name must contain Mr.Xyz Xxxx ');
	$.validator.addMethod("MothernameValidator", function(value, element) 
	{		return /^(Mrs).{1}[A-Za-z\s]{3,}$/.test(value);}, 'Please enter a valid name.Name must contain Mr.Xyz Xxxx ');
	$.validator.addMethod("pinCodeValidator", function(value, element) 
	{		return /^[0-9]{6}$/i.test(value);}, 'Please enter a valid pinCode.');
	$.validator.addMethod("enrollmentNoValidator", function(value, element)
	{		return /^(19|20)[0-9]{2}\/[0-9]{4}$/i.test(value);}, 'Please enter a valid enrollment number.');
	$.validator.addMethod("valueNotEqualValidator", function(value, element,arg)
			{		return arg!== value}, 'Please select the option.');
	  // Initialize form validation on the enrollment form.
	  
	  $('#enroll').validate({
		// Specify validation rules
		rules: {
		  // The key name on the left side is the name attribute
		  // of an input field. Validation rules are defined
		  // on the right side
		  pinCode: {
						required: true,
						pinCodeValidator: true
		  			},
		  enrollmentNo: 
		  			{
						required: true,
						enrollmentNoValidator: true
		  			},
                fName:
                	{
                      required:true,
                      FathernameValidator:true
                  	},
                mName:
                	{
                      required:true,
                      MothernameValidator:true
                  	},
                gName:
                	{
                      required:true,
                      FathernameValidator:true
                  	},
               bDate:
               		{
                      required:true
                  	},
            language:
            		{
                      required:true,
                      valueNotEqualValidator:"Select"
                  	},
              hostel:
              		{
                      required:true,
                      valueNotEqualValidator:"Select"
                  	},
              cName:
              		{
                      required:true,
                      valueNotEqualValidator:"Select"
                  	},
              state:
              		{
                      required:true,
                      valueNotEqualValidator:"Select"
                  	},
            cSelect:
            		{
                      required:true,
                      valueNotEqualValidator:"Select"
                  	}
		},
		// Specify validation error messages
		messages: {
		  		
			pinCode: 
					{
		  				required: "Please enter pinCode."
		  			},		 
		  enrollmentNo: 
		  			{
		  				required: "Please enter enrollment number."
		  			},
                fName:
                	{
                      	required:"Please enter your father's name."
                  	},
                mName:
                	{
                      	required:"Please enter your mother's name."
                  	},
                gName:
                	{
                      	required:"Please enter your guardaian's name."
                  	},
                bDate:
                	{
                      	required:"Please enter your date of birth."
                  	},
              language:
              		{
                      	required:"Please choose any language.",
                      	valueNotEqualValidator:"Please choose one language."
                  	},
               hostel:
               		{
                      	required:"Please choose your current hostel.",
                      	valueNotEqualValidator:"Please choose your hostel."
                  	},
               	cName:
               		{
                      	required:"Please choose your regular course.",
                      	valueNotEqualValidator:"Please choose your current regular course."
                  	},
                state:
                	{
                      	required:"Please choose your domicile state.",
                      	valueNotEqualValidator:"Please choose your domicile state."
                  	},
              cSelect:
              		{
                      	required:"Please choose your course.",
                      	valueNotEqualValidator:"Please choose your course in which you want to enroll."
                  	}
	},
		errorPlacement: function(error, element) 
		{
			if (element.attr("name") == "pinCode" )  //Name of input field
				error.appendTo('#pinCodeError');
			if (element.attr("name") == "enrollmentNo" ) 
				error.appendTo('#enrollmentNoError');
            if (element.attr("name") == "fName" ) 
				error.appendTo('#fNameError');
           	if (element.attr("name") == "mName" ) 
				error.appendTo('#mNameError');
            if (element.attr("name") == "gName" ) 
				error.appendTo('#gNameError');
            if (element.attr("name") == "bDate" ) 
				error.appendTo('#bDateError');
           	if (element.attr("name") == "language" ) 
				error.appendTo('#languageError');
          	if (element.attr("name") == "hostel" ) 
				error.appendTo('#hostelError');
            if (element.attr("name") == "state" ) 
				error.appendTo('#stateError');
            if (element.attr("name") == "cName" ) 
				error.appendTo('#cNameError');
            if (element.attr("name") == "cSelect" ) 
				error.appendTo('#cSelectError');
		},
		// Make sure the form is submitted to the destination defined
		// in the "action" attribute of the form when valid
		submitHandler: function(form) 
		{
		 	NextButton();
		}
	  });
	});
</script>
	<script type="module">
		import states from '../../js/pages/state.js'; 
		$(document).ready(function()
			{
				$.post("http://localhost:9090/BCPMS/pages/forms/enroll.jsp",{run:"load"},function(data,status)
					{
						if(data!=="invalid") 
							{
								$('#smartid').val(data.s_id);
								$('#studentname').val(data.s_name);
								$('#aadhar').val(data.s_adhaar);
								$('#email_id').val(data.s_email);
	 							$('#mobile').val(data.s_contact);
 							} 
						else 
							{ 
								alert("You aren't allowed to enroll with this Id.Please try with the valid user id");
							} 
					})
				$.post("http://localhost:9090/BCPMS/pages/common/ListPopulate.jsp",{tableName:"course_details"},function(data,status)
					{
						if(data!=="invalid")
							{ 
								let data1=JSON.parse(data); 
								if(data1.length>0) 
									{ 
										let sel = $('#course')[0]; 
										let selectHtml=`<option value="Select">Select*</option>` 
										$(selectHtml).appendTo(sel); 
										data1.forEach(function(object)
										{ 
											let course_list=`<option>${object.course_name}</option>` 
											$(course_list).appendTo(sel); 
										}) 
									} 
							} 
					}) 
				$.post("http://localhost:9090/BCPMS/pages/common/ListPopulate.jsp",{tableName:"hostel_name"},function(data,status)
					{
						if(data!=="invalid")
							{ 
								let data1=JSON.parse(data); 
								if(data1.length>0) 
									{ 
										let sel = $('#hostel')[0]; 
										let selectHtml=`<option value='Select'>Select*</option>` 
										$(selectHtml).appendTo(sel); 
										data1.forEach(function(object)
										{ 
											let hostel_list=`<option>${object.hostelName}</option>` 
											$(hostel_list).appendTo(sel); 
										}) 
									} 
							} 
					}) 
				let sel = $('#state_dropdown')[0]; 
				let selectHtml=`
				<option value="Select">Select*</option>` 
				$(selectHtml).appendTo(sel); 
				let statearray = Object.values(states); 
				statearray.forEach(val=>{
				let	state_list=`<option>${val}</option>` 
				$(state_list).appendTo(sel);
			}) 
	})
	</script>
	<script>
		function NextButton() {
			$.post( "http://localhost:9090/BCPMS/pages/forms/enroll.jsp",
				{
					run: "button",
					father_name: $('#fathername').val(),
					mother_name: $('#mothername').val(),
					guardian_name: $('#guardianname').val(),
					dob: $('#dob').val(),
					language: $('#language').children("option:selected").val(),
					hostel: $('#hostel').children("option:selected").val(),
					current_course: $('#coursename').children("option:selected").val(),
					enrolment_no: $('#enrolmentNo').val(),
					state: $('#state_dropdown').children("option:selected").val(),
					address: $('#address').val(),
					short_term_course: $('#course').children("option:selected").val(),
					pincode: $('#pincode').val()
				},
				function (data, status) {
					if (data !== "invalid") {
						window.location.href = data;
					} else {
						alert("Registeration failed.Try again");
					}
				})
		}
	</script>
</body>
</html>